# 公共文档模块接口文档

<div style="float:right">

|作者|日期|
|----|---|
|刘成|2019年9月2日|

</div>

## 实现人员

* 前端：刘珂铭

* 后端：胡现荣、刘成

## 配置说明

#### 代码位置

	主分支：project/electronGovernment
	文件位置：ibaseweb\vueIndex\src\components\electronGovernment\publicDocument.vue

#### 模块配置

	在系统配置 --> 模块配置中新建模块：

1. 选中上级模块，点击新建：1输入模块名称：公共文档模块

2. 重点是2，当前配置方法是在模块地址中输入：`#electronGovernment/publicDocument`

> tips：排序值根据需要进行排序

## 接口

#### 接口1：新建个人文件

> `/setFolder`

**请求类型**：`GET`、`POST`

**请求参数**：

```
{
	prid="0"     //父级节点文件id，如果为第一级节点则为0
	wjmc="新建目录名"
}
```
**返回参数**

```json
{
	code: "1"    //1代表成功，0代表失败
	errMsg: "错误信息"
}
```
####接口2：查询个人文件

> `/getSharedPersonalFiles`

*请求类型*：`GET`、`POST`

**请求数据** : 
```
rid:"da66c4c5-aa3d-4606-8d02-d6182e1f7d0c"  //文件与文件夹唯一标识
```

**返回数据**

```json
{
	"code": "1",
	"data": [
{
	"rid": "2af92faa-9a01-4972-8c4e-5429accfc6c9",
	"srid": null,
	"prid": "da66c4c5-aa3d-4606-8d02-d6182e1f7d0c",
	"wjmc": "test.txt",
	"wjms": null,
	"scrid": "48fe2285-86ce-4941-a90f-3ca470b00812",
	"scname": "钟华山",
	"wjlx": "1",
	"wjdx": "0B   ",
	"scsj": "2019-08-20 14:16:46",
	"sclj": "%%jobfiles%/201908/da66c4c5-aa3d-4606-8d02-d6182e1f7d0c/71c93700-dc45-4b30-b5f5-ba3919088b98.txt"
}
	]
}
```

#### 接口3：当前用户共享文件分页显示

	将共享文件的详细信息分页显示出来

> `/getSharedFolders`

*请求类型*：`GET`、`POST`

**请求数据**: 

```json
{
	page: 1,	// 当前页码
	rows: 50,	// 每页显示条目
	searchTXt: "搜索字段"
}
```
**返回数据**
```
{
"msg": {                                         //执行结果
"rows": [                                        //结果集
{
"rid": "d977c5a5-453e-4d08-ac33-4fd40185abef",   //唯一标识
"srid": null,                                    //关联ID
"prid": "5782e6cb-5221-40eb-bc0e-857c54272b5e",  //上级目录标识
"wjmc": "1099.txt",                              //文件名称
"wjms": null,                                    //文件描述
"scrid": "8be3a512-9c0e-49db-bf42-0b4eb142f3ae", //用户id
"scname": "麦卫忠",                               //用户名
"wjlx": "1",                                     //文件类型（1为文件，0为文件夹）
"wjdx": "0B   ",                                 //文件大小
"scsj": "2019-08-29 18:28:33",                   //上传时间
"sclj": "%%jobfiles%/201908/5782e6cb-5221-40eb-bc0e-857c54272b5e/145c527d-cce4-4163-86ea-53873d9380d6.txt"  //上传路径
}
],
"total": 1                                       //查询总数
},
"code": "1"                                      //1代表成功，0返回错误信息
}
```
> `注`：上传宏路径(sclj)需请求接口：`formengineWebService/public/preview`
此接口会返回文件具体路径

#### 接口4：修改文件夹名称

> `/updataShareFile`

*请求类型*：`GET`、`POST`

**请求数据**: 
```
{
	prid:"0"        //父级节点文件id，如果为第一级节点则为0
	wjmc:"文件名称"
	rid:"文件唯一标识"
}
```
**返回数据**

```json
{
	code: "1"    //1代表成功，0代表失败
	errMsg: "错误信息"
}
```
#### 接口5：删除文件夹与文件

	这里会同时更新个人文件，也就是修改个人文件

> `/deleteFiles`

*请求类型*：`GET`、`POST`

**请求数据**

```
rid: "90bdde07-b591-47b9-81b9-91ca91e5415d",	// 要删除文件或文件夹的Id
```

> `注`：rid如果是文件夹id，连同子文件夹和文件都删除

**返回数据**

```
{
	code: "1"    //1代表成功，0代表失败
	errMsg: "错误信息"
}
```

#### 接口6：当前用户文档共享

> `/setRelate`

*请求类型*：`GET`、`POST`

**请求数据**: 
```
{
	qxuid: "8be3a512-9c0e-49db-bf42-0b4eb142f3ae"  //被授权用户ID
	frid: "da66c4c5-aa3d-4606-8d02-d6182e1f7d0c"   //文件id
}
```
**返回数据**
```
{
	code: "1"    //1代表成功，0代表失败
	errMsg: "错误信息"
}
```

#### 接口7：获取个人文件的授权人

	获取某个节点的授权人

> `/getPermissionUsers`

*请求类型*：`GET`、`POST`

**请求数据**: 

```
rid: "dc792782-9a38-412e-ab0f-d0f92a5673e9"	// 当前节点的ID
```

**返回数据**

```json
{
	id: "dc792782-9a38-412e-ab0f-d0f92a5673e9,dc792782-9a38-412e-ab0f-d0f92a5673e9",
	text: "国土资源厅/厅招办/梁明,国土资源厅/厅招办/张三"
}
```

> 注：返回对应组织成员要带部门结构，每个权限人以英文","分割

#### 接口8：上传文件

> `/uploadDocuments`

*请求类型*：`GET`、`POST`

**请求数据**：
```
parentId: "0"    //父级节点文件id，如果为第一级节点则为0
```
**返回数据**
```
{
	code: "1"
	data: ["%%jobfiles%/201909/0/d77d8b75-5f6f-4d3a-906f-ea92d126e5dc.txt"]
}
```

#### 接口9：下载文件或者文件夹内所有文件，打包成压缩包

*请求类型*：`GET`、`POST`

**请求数据**：
```
ridString="13664f25-3217-417d-b783-85cd6cad3f78::1||6d590420-4ef2-4f07-a55d-0bb474f8834b::0"
```
> 注：ridString组成约定为：文件夹或文件组成的字符串::文件类型。如果有多个选项，则用||分隔